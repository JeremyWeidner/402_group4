---
title: "logistic_model"
author: "Jeremy Weidner"
date: "December 1, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Notebook to begin fitting models on hotel data


JAEHEE
1) A schematic showing the relationship between the predictors and out come (include a list of variables and how they are measured)
- we will use EDA slides for this

2) A clear statement of the questions you are trying to answer.
- included in slides

3) Acsrtaining that histograms looks good, frequenicies within different cells look reasonable, if need be pool categories.
- also solved in EDA




JEREMY
4) A table of odds ratios with 95% CI and p-values that summarizes the results of your model.


5) Interpretation of odds ratios.



DAVID
6) Plot of interaction effect in the model and trying to interpret it. The fixed effect package should also give you plots for all predictors in the model.

7) mmp plots to see if model fits the data, as well as the pearson Chi-square test.

8) checking for outliers and influential points.

9) Some measure of pesudo R-square and accuracy of the model.




```{r cars}
library(effects)

# install.packages("effects")

hotels <- read.csv("../raw_data/hotels_mod1.csv")
head(hotels)
summary(hotels)
```



```{r}
# 
# model_1 <- glm(is_canceled ~ lead_time + arrival_date_month + adults + children + babies + country + previous_cancellations + hotel + adr, family = binomial(), data = hotels)

# taking out country and children because they're not significant initially
model_2 <- glm(is_canceled ~ arrival_date_season*hotel + lead_time + adults +  babies +  international_booking + Stay_length + previous_cancellations + adr + reassigned, family = binomial(), data = hotels)
summary(model_2)
anova(model_2)

```




# odds ratio

```{r}


round(exp(cbind(Estimate=coef(model_2), confint(model_2))),2)



```

# plot interaction effect

```{r}
# plot(allEffects(model_2, ask = FALSE))

plot(allEffects(model_2), ask=FALSE, main = "Interaction Effect: ")


```







# mmp plot
```{r}

library(car)
mmp(model_2)

```



# pearson chi square
```{r}


print(paste("Pearsonâ€™s X^2", round(sum(residuals(model_2, type="pearson")^2),3)))




```

# outlier test & influential points

```{r}

outlierTest(model_2)

residualPlots(model_2)

influencePlot(model_2)


```

































































































































































































































































